<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Adkira â€“ ValidaÃ§Ã£o de Eventos</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/html5-qrcode"></script>
  <style>
    #progressBar{transition:width .3s}
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center p-4">

  <!-- TABS NAVIGATION -->
  <div class="flex space-x-4 mb-4">
    <button onclick="showTab('clienteTab')" class="px-4 py-2 bg-indigo-600 text-white rounded">Cliente</button>
    <button onclick="requestAdminAccess()" class="px-4 py-2 bg-gray-300 text-black rounded">Admin</button>
  </div>

  <!-- LOGIN -->
  <section id="login" class="w-full max-w-sm bg-white rounded-xl shadow p-6 space-y-3">
    <h2 class="text-xl font-bold text-center">Login</h2>
    <input id="username" class="w-full border rounded p-2" placeholder="Utilizador" />
    <input id="password" type="password" class="w-full border rounded p-2" placeholder="Senha" />
    <button onclick="customLogin()" class="w-full bg-indigo-600 text-white rounded py-2">Entrar</button>
    <div id="loginError" class="text-red-600 text-center text-sm"></div>
  </section>

  <!-- CLIENTE ABA -->
  <section id="clienteTab" class="hidden w-full max-w-md bg-white rounded-xl shadow p-4 space-y-4">
    <h2 class="text-lg font-semibold text-center">ValidaÃ§Ã£o de Convidados</h2>
    <div class="flex gap-2">
      <input id="codeInput" class="flex-1 border rounded p-2" placeholder="CÃ³digo ou QR" />
      <button onclick="verifyCode()" class="bg-indigo-600 text-white px-4 rounded">OK</button>
    </div>
    <button onclick="openScanner()" class="w-full bg-emerald-600 text-white py-2 rounded">ðŸ“· Ler QR Code</button>

    <div class="text-center text-sm">VÃ¡lidos: <span id="usedTxt">0</span>/<span id="limitTxt">0</span></div>
    <div class="w-full h-3 bg-gray-200 rounded"><div id="progressBar" class="h-full bg-indigo-600"></div></div>

    <ul id="guestList" class="mt-4 max-h-60 overflow-y-auto divide-y"></ul>
    <div id="qrDiv" class="hidden w-full max-w-xs mx-auto"></div>
  </section>

  <!-- ADMIN ABA -->
  <section id="adminTab" class="hidden w-full max-w-md bg-white rounded-xl shadow p-4 space-y-4">
    <h2 class="text-lg font-semibold text-center">Painel Admin</h2>
    <form id="createForm" class="space-y-2">
      <input id="newUser"     class="w-full border rounded p-2" placeholder="Novo utilizador" />
      <input id="newPass"     class="w-full border rounded p-2" placeholder="Senha" />
      <input id="newEvent"    class="w-full border rounded p-2" placeholder="ID do evento" />
      <input id="newLimit"    type="number" class="w-full border rounded p-2" placeholder="Limite inicial" />
      <button type="button" onclick="createUserAndEvent()" class="w-full bg-indigo-600 text-white py-2 rounded">Criar utilizador & evento</button>
    </form>
    <hr/>
    <h3 class="font-semibold">Carregar convidados (ficheiro .txt)</h3>
    <input type="file" accept=".txt" onchange="uploadTxt(event)" />
    <p class="text-xs text-gray-500">Formato: cÃ³digo, nome (um por linha)</p>
  </section>

  <footer class="mt-8 text-xs text-gray-500">Adkira Media Â© 2025</footer>

  <script>
    const ADMIN_CODE = "2025@!!Kiara1993";

    function showTab(tabId) {
      document.getElementById('clienteTab').classList.add('hidden');
      document.getElementById('adminTab').classList.add('hidden');
      document.getElementById(tabId).classList.remove('hidden');
    }

    function requestAdminAccess() {
      const input = prompt("Digite o cÃ³digo de administrador:");
      if (input === ADMIN_CODE) {
        showTab('adminTab');
      } else {
        alert("CÃ³digo incorreto.");
      }
    }
  </script>
</body>
</html>
